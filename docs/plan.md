# 開発計画: RSS類似記事抽出Gradioアプリ

## 目的
- RSSフィードを登録し、ユーザが選択した記事に類似した記事をBERTエンコーダーとコサイン類似度で抽出するGradioアプリを構築する。

## 主要機能要件
- **フィード管理**: RSSフィードの登録・削除・一覧表示。
- **記事取得と保存**: 定期的なRSS取得と記事メタデータの永続化。
- **テキスト処理**: 記事本文抽出と前処理。
- **埋め込み生成**: BERTベースのエンコーダーで記事テキストを埋め込み化。
- **類似度計算**: コサイン類似度による類似記事ランキング。
- **UI**: Gradioでのフィード管理、記事選択、結果表示。
- **設定管理**: 更新間隔やモデル設定の管理インターフェース。

## アーキテクチャ構成案
- `app/`: Gradio UIとアプリケーションエントリポイント。
- `services/rss.py`: RSS取得と更新処理。
- `services/embedder.py`: BERTモデルのロードと埋め込み生成。
- `services/similarity.py`: 類似度計算ロジック。
- `storage/`: SQLiteやローカルデータベース、記事/埋め込みキャッシュ。
- `scheduler.py`: APSchedulerやバックグラウンドスレッドでの定期更新。

## 技術選定
- **アプリケーションフレームワーク**: Gradio。
- **埋め込みモデル**: `sentence-transformers/all-MiniLM-L6-v2` など軽量BERTモデル。
- **RSS解析**: `feedparser`。
- **本文抽出**: `newspaper3k` または `readability-lxml`。
- **類似度計算**: `numpy` または `scikit-learn` の pairwise cosine。
- **永続化**: `sqlite3`（必要に応じて`sqlalchemy`）。
- **設定管理**: `python-dotenv`。

## 開発ステップ
1. 環境構築: 仮想環境作成、依存ライブラリインストール。
2. RSS管理モジュール: フィード登録/削除、最新取得、DB保存処理。
3. 記事テキスト抽出と前処理ロジックの実装。
4. BERT埋め込みサービス構築（バッチ処理とキャッシュ対応）。
5. 類似度検索ロジック実装（正規化ベクトル保存と近傍検索）。
6. Gradio UIプロトタイプ構築（フィード管理、記事一覧表示）。
7. 類似記事結果表示画面とランキング整形。
8. バックグラウンド更新処理と例外ハンドリング。
9. ロギング・モニタリング・エラー通知整備。
10. テスト（単体・統合）とドキュメント整備。

## 検討事項
- 大量記事対応時の埋め込み更新コスト。必要に応じてベクトルDB（FAISS等）検討。
- 日本語記事中心の場合に適した日本語特化モデルの選定。
- 非同期処理やキューマネジメント（asyncio、RQ、Celery等）の導入要否。
- Gradio共有設定やデプロイ形態（Hugging Face Spaces、Dockerなど）。

## テスト計画
- RSS取得モジュールのモックテスト。
- 埋め込み・類似度計算の機能テスト。
- Gradio UIのフロー確認。
- 固定データセットによる回帰テストの仕組み整備。

## 次のアクション
- 依存ライブラリリストを確定し `requirements.txt` を作成する。
- プロジェクトディレクトリと基本モジュールのスケルトンを準備する。
- まずはPoCとして固定フィードと類似度計算までを通すデモを構築する。

